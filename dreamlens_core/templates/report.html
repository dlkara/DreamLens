{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>꿈 일기 분석 리포트</title>
    <link rel="stylesheet" href="{% static 'css/report.css' %}">
</head>
<body>
    {% include 'header.html' %}

    <h2>내 일기장 분석 리포트</h2>

    <div class="month-nav">
        <a href="{% url 'report' prev_yyyymm %}">◀</a>

        <span id="monthText" class="clickable">{{ year }}년 {{ month }}월</span>

        {% if next_yyyymm <= today_yyyymm %}
            <a href="{% url 'report' next_yyyymm %}">▶</a>
        {% else %}
            <span class="disabled">▶</span>
        {% endif %}
    </div>

    <!-- 드롭다운 선택기 (기본 숨김) -->
    <div class="selector hidden" id="selectorBox">
        <select id="yearSelect">
            {% for y in year_list %}
            <option value="{{ y }}" {% if y == year %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
        </select>
        <select id="monthSelect">
            {% for m in month_list %}
            <option value="{{ m|stringformat:"02d" }}" {% if m == month %}selected{% endif %}>{{ m }}</option>
            {% endfor %}
        </select>
    </div>

    <!-- 차트 정보 -->
    <div id="reportInfo"
         data-year="{{ year }}"
         data-month="{{ month }}"
         data-has-data="{{ has_data|yesno:'1,0' }}">
    </div>

    <div class="report-container">
        <div class="tabs">
            <button id="typeTab" class="tab active">꿈 종류 분석</button>
            <button id="emotionTab" class="tab">감정 분석</button>
        </div>

        <div class="chart-wrapper">
            <canvas id="reportChart"></canvas>
            <div class="result-text" id="resultText">–</div>
        </div>
    </div>

    {% include 'footer.html' %}

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
    <script>
        const dreamLabels   = {{ dream_labels|safe }};
        const dreamData     = {{ dream_data|safe }};
        const emotionLabels = {{ emotion_labels|safe }};
        const emotionIcons  = {{ emotion_icons|safe }};
        const emotionData   = {{ emotion_data|safe }};
    </script>
    <script src="{% static 'js/report.js' %}"></script>
</body>
</html>
