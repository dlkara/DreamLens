{% load static %}
<link rel="stylesheet" href="{% static 'css/header.css' %}?v=3">

<!-- 상단바 전체 -->
<div class="header-bar">
    <!-- 햄버거 버튼 -->
    <button id="hamburgerBtn" class="hamburger">☰</button>

    <!-- 로고 -->
    <a href="{% url 'index' %}" class="logo-bar">DreamLens</a>
</div>

<!-- 사이드 패널 -->
<div class="side-panel" id="sidePanel">
    <div style="text-align:right;">
        <button id="closePanelBtn">❌</button>
    </div>

    {% if user.is_authenticated %}
        <p>안녕하세요!</p>
        <h3>{{ user.nickname|default:user.username }} 님</h3>
        <a href="{% url 'mypage' %}" class="btn">내 정보 수정</a>
        <a href="{% url 'logout' %}" class="btn">로그아웃</a>
    {% else %}
        <p>만나서 반갑습니다!</p>
        <a href="{% url 'login' %}" class="btn">로그인</a>
        <a href="{% url 'register_user' %}" class="btn">회원가입</a>
    {% endif %}

    <hr>

    <!-- 메뉴 항목 -->
    <a href="{% url 'dream_interpreter' %}" class="menu">🔮 해몽하기</a>
    <a href="{% url 'dream_dict' %}" class="menu">📖 꿈 사전</a>
    <a href="{% url 'dream_combiner' %}" class="menu">🧩 꿈 조합기</a>
    <a href="javascript:void(0)" class="menu" onclick="goToProtectedPage('{% url 'diary_list_base' %}')">📘 내 일기장</a>
    <a href="javascript:void(0)" class="menu" onclick="goToProtectedPage('{% url 'report' %}')">📊 분석 리포트</a>
</div>

<!-- 햄버거 동작 및 보호된 페이지 제어 -->
<script src="{% static 'js/header.js' %}"></script>
<script>
    function goToProtectedPage(targetUrl) {
        const isLoggedIn = "{{ user.is_authenticated|yesno:'true,false' }}" === "true";
        if (isLoggedIn) {
            window.location.href = targetUrl;
        } else {
            alert("로그인이 필요한 서비스입니다.");
            window.location.href = "{% url 'login' %}";
        }
    }
</script>
